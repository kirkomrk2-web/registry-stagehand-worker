# üéØ HOSTINGER DEPLOYMENT - –§–ò–ö–°–ò–†–ê–ù–ò –§–ê–ô–õ–û–í–ï

## ‚úÖ –ö–∞–∫–≤–æ –µ –æ–ø—Ä–∞–≤–µ–Ω–æ?

**–ü—Ä–æ–±–ª–µ–º:** –ö–æ–≥–∞—Ç–æ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–∏ —Å–µ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–∞—Ö–∞ –ø—Ä–µ–∑ —á–∞—Ç–∞ –Ω–∞ —Å–∞–π—Ç–∞, –∏–º–∞—à–µ –≥—Ä–µ—à–∫–∞ "Unregistered API key" –∏ –¥–∞–Ω–Ω–∏—Ç–µ –ù–ï —Å–µ –∑–∞–ø–∏—Å–≤–∞—Ö–∞ –≤ `user_registry_checks` –∏ `verified_owners` —Ç–∞–±–ª–∏—Ü–∏—Ç–µ.

**–†–µ—à–µ–Ω–∏–µ:** 
1. ‚úÖ **Backend (Supabase Edge Function `registry_check`)** - –û–±–Ω–æ–≤–µ–Ω–∞ –¥–∞ —Ä–∞–±–æ—Ç–∏ —Å—ä—Å –≤—Å–∏—á–∫–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ
2. ‚úÖ **Frontend (Hostinger)** - –û–ø—Ä–æ—Å—Ç–µ–Ω –∫–æ–¥, –ø—Ä–µ–º–∞—Ö–Ω–∞—Ç–æ –¥–∏—Ä–µ–∫—Ç–Ω–æ—Ç–æ –∏–∑–≤–∏–∫–≤–∞–Ω–µ –Ω–∞ –∑–∞—â–∏—Ç–µ–Ω–∏ —Ñ—É–Ω–∫—Ü–∏–∏

---

## üì¶ –§–∞–π–ª–æ–≤–µ –∑–∞ –∫–æ–ø–∏—Ä–∞–Ω–µ –≤ Hostinger

### 1. `useRegistryCheck.js`
**–õ–æ–∫–∞—Ü–∏—è:** `src/hooks/useRegistryCheck.js`

**–ü—Ä–æ–º–µ–Ω–∏:**
- ‚ùå –ü—Ä–µ–º–∞—Ö–Ω–∞—Ç–æ –¥–∏—Ä–µ–∫—Ç–Ω–æ –∏–∑–≤–∏–∫–≤–∞–Ω–µ –Ω–∞ `users_pending_worker` (–∑–∞—â–∏—Ç–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è)
- ‚ùå –ü—Ä–µ–º–∞—Ö–Ω–∞—Ç–æ –¥–∏—Ä–µ–∫—Ç–Ω–æ –∏–∑–≤–∏–∫–≤–∞–Ω–µ –Ω–∞ `send-registry-email`
- ‚úÖ –°–∞–º–æ –∏–∑–≤–∏–∫–≤–∞ `registry_check` - —Ç—è –≤–µ—á–µ –ø—Ä–∞–≤–∏ –≤—Å–∏—á–∫–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ
- ‚úÖ –û–ø—Ä–æ—Å—Ç–µ–Ω–æ error handling

**–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:**
```bash
# –ö–æ–ø–∏—Ä–∞–π HOSTINGER_FIXED_FILES/useRegistryCheck.js
# –ó–∞–º–µ—Å—Ç–∏ —Ñ–∞–π–ª–∞: src/hooks/useRegistryCheck.js
```

---

### 2. `useChatLogic.js`
**–õ–æ–∫–∞—Ü–∏—è:** `src/hooks/useChatLogic.js`

**–ü—Ä–æ–º–µ–Ω–∏:**
- ‚ùå –ü—Ä–µ–º–∞—Ö–Ω–∞—Ç–æ –¥–∏—Ä–µ–∫—Ç–Ω–æ –∏–∑–≤–∏–∫–≤–∞–Ω–µ –Ω–∞ `users_pending_worker` (–∑–∞—â–∏—Ç–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è)
- ‚úÖ –°–∞–º–æ –∏–∑–≤–∏–∫–≤–∞ `checkRegistry()` –∫–æ–π—Ç–æ –µ hook –æ—Ç `useRegistryCheck`
- ‚úÖ –í—Å–∏—á–∫–æ –æ—Å—Ç–∞–Ω–∞–ª–æ –µ —Å—ä—â–æ—Ç–æ

**–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:**
```bash
# –ö–æ–ø–∏—Ä–∞–π HOSTINGER_FIXED_FILES/useChatLogic.js
# –ó–∞–º–µ—Å—Ç–∏ —Ñ–∞–π–ª–∞: src/hooks/useChatLogic.js
```

---

## üîß Backend –ø—Ä–æ–º–µ–Ω–∏ (–≤–µ—á–µ deploy-–Ω–∞—Ç–∏ –≤ Supabase)

### Edge Function: `registry_check`
**–í–µ—Ä—Å–∏—è:** 34 (deployed —É—Å–ø–µ—à–Ω–æ ‚úÖ)

**–ö–∞–∫–≤–æ –ø—Ä–∞–≤–∏ —Å–µ–≥–∞:**
1. ‚úÖ –¢—ä—Ä—Å–∏ —á–æ–≤–µ–∫–∞ –≤ CompanyBook API (–ø—Ä–µ–∑ proxy)
2. ‚úÖ –ò–∑–≤–ª–∏—á–∞ –≤—Å–∏—á–∫–∏ –Ω–µ–≥–æ–≤–∏ —Ñ–∏—Ä–º–∏ —Å 100% ownership
3. ‚úÖ –û–±–æ–≥–∞—Ç—è–≤–∞ –¥–∞–Ω–Ω–∏—Ç–µ –∑–∞ –≤—Å—è–∫–∞ —Ñ–∏—Ä–º–∞
4. ‚úÖ **–ó–∞–ø–∏—Å–≤–∞ –≤ `user_registry_checks` —Ç–∞–±–ª–∏—Ü–∞—Ç–∞** ‚≠ê
5. ‚úÖ **–û–±–Ω–æ–≤—è–≤–∞ `users_pending.status`** ‚≠ê
6. ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∏–∑–≤–∏–∫–≤–∞ `users_pending_worker`** ‚≠ê
7. ‚úÖ **–ò–∑–ø—Ä–∞—â–∞ email –∏–∑–≤–µ—Å—Ç–∏–µ** ‚≠ê

**–í–∞–∂–Ω–æ:** –í—Å–∏—á–∫–æ —Å–µ —Å–ª—É—á–≤–∞ **backend**, **frontend** —Å–∞–º–æ –∏–∑–≤–∏–∫–≤–∞ `registry_check` –∏ –ø–æ–ª—É—á–∞–≤–∞ —Ä–µ–∑—É–ª—Ç–∞—Ç–∞.

---

## üöÄ –°—Ç—ä–ø–∫–∏ –∑–∞ –¥–µ–ø–ª–æ–π –≤ Hostinger

### –°—Ç—ä–ø–∫–∞ 1: Backup –Ω–∞ —Ç–µ–∫—É—â–∏—Ç–µ —Ñ–∞–π–ª–æ–≤–µ
```bash
# –í Hostinger File Manager –Ω–∞–ø—Ä–∞–≤–∏ backup:
- src/hooks/useRegistryCheck.js ‚Üí useRegistryCheck.js.backup
- src/hooks/useChatLogic.js ‚Üí useChatLogic.js.backup
```

### –°—Ç—ä–ø–∫–∞ 2: –ö–∞—á–≤–∞–Ω–µ –Ω–∞ –Ω–æ–≤–∏—Ç–µ —Ñ–∞–π–ª–æ–≤–µ
1. –û—Ç–≤–æ—Ä–∏ Hostinger File Manager
2. –ù–∞–≤–∏–≥–∏—Ä–∞–π –¥–æ `src/hooks/`
3. –ö–∞—á–∏ –Ω–æ–≤–∏—Ç–µ —Ñ–∞–π–ª–æ–≤–µ:
   - `useRegistryCheck.js` (–æ—Ç HOSTINGER_FIXED_FILES/)
   - `useChatLogic.js` (–æ—Ç HOSTINGER_FIXED_FILES/)

### –°—Ç—ä–ø–∫–∞ 3: Rebuild –Ω–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ—Ç–æ
```bash
# Ako –∏–∑–ø–æ–ª–∑–≤–∞—à build process:
npm run build
# –∏–ª–∏
yarn build

# Ako –µ –¥–∏—Ä–µ–∫—Ç–Ω–æ React –≤ Hostinger:
# –°–∞–º–æ refresh –Ω–∞ –±—Ä–∞—É–∑—ä—Ä–∞ —Å–ª–µ–¥ –∫–∞—á–≤–∞–Ω–µ –Ω–∞ —Ñ–∞–π–ª–æ–≤–µ—Ç–µ
```

### –°—Ç—ä–ø–∫–∞ 4: –¢–µ—Å—Ç–≤–∞–Ω–µ
1. –û—Ç–≤–æ—Ä–∏ —Å–∞–π—Ç–∞: `https://wallesters.com` (–∏–ª–∏ —Ç–≤–æ—è –¥–æ–º–µ–π–Ω)
2. –û—Ç–≤–æ—Ä–∏ —á–∞—Ç–∞
3. –ö–ª–∏–∫–Ω–∏ "–°—ä–∑–¥–∞–π –ø—Ä–æ—Ñ–∏–ª"
4. –ü–æ–ø—ä–ª–Ω–∏:
   - –ò–º–µ: `–¢–µ—Å—Ç` 
   - –ü—Ä–µ–∑–∏–º–µ: `–¢–µ—Å—Ç–æ–≤`
   - –§–∞–º–∏–ª–∏—è: `–¢–µ—Å—Ç–æ–≤—Å–∫–∏`
   - –î–∞—Ç–∞: `15.05.1990`
   - Email: `test_$(date +%s)@example.com` (—É–Ω–∏–∫–∞–ª–µ–Ω)
5. **–û—á–∞–∫–≤–∞–Ω–∏ —Ä–µ–∑—É–ª—Ç–∞—Ç–∏:**
   - ‚úÖ –°—ä–æ–±—â–µ–Ω–∏–µ "–ü–µ—Ä—Ñ–µ–∫—Ç–Ω–æ! –í–∞—à–∏—Ç–µ –¥–∞–Ω–Ω–∏ —Å–∞ –∑–∞–ø–∞–∑–µ–Ω–∏..."
   - ‚úÖ –°—ä–æ–±—â–µ–Ω–∏–µ "–ê–∫–æ –∏—Å–∫–∞—à –ø—Ä–µ–∑ —Ç–æ–≤–∞ –≤—Ä–µ–º–µ..."
   - ‚úÖ –ù–ï —Ç—Ä—è–±–≤–∞ –¥–∞ –∏–º–∞ error –≤ –∫–æ–Ω–∑–æ–ª–∞—Ç–∞
   - ‚úÖ –°–ª–µ–¥ 10-15 —Å–µ–∫ –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤ Supabase:
     - –ó–∞–ø–∏—Å –≤ `user_registry_checks` ‚úÖ
     - –ó–∞–ø–∏—Å –≤ `verified_owners` ‚úÖ (–∞–∫–æ –∏–º–∞ —Ñ–∏—Ä–º–∏)
     - Status –≤ `users_pending` = `ready_for_stagehand` –∏–ª–∏ `processing` ‚úÖ

---

## üîç Debugging

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ª–æ–≥–æ–≤–µ –≤ Supabase
1. –û—Ç–≤–æ—Ä–∏ Supabase Dashboard
2. –ò–¥–∏ –Ω–∞ Functions ‚Üí `registry_check` ‚Üí Logs
3. –¢—ä—Ä—Å–∏ –∑–∞ email –∞–¥—Ä–µ—Å–∞ –∫–æ–π—Ç–æ —Ç–µ—Å—Ç–≤–∞—à
4. –¢—Ä—è–±–≤–∞ –¥–∞ –≤–∏–¥–∏—à:
```
[registry_check] Inserting into user_registry_checks for test@example.com
[registry_check] Successfully inserted user_registry_checks
[registry_check] Updating users_pending status to ready_for_stagehand
[registry_check] Successfully updated users_pending status
[registry_check] Triggering users_pending_worker for test@example.com
[registry_check] users_pending_worker completed successfully
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ Browser Console (F12)
–°–ª–µ–¥ –∫–∞—Ç–æ –∏–∑–ø—Ä–∞—Ç–∏—à —Ñ–æ—Ä–º–∞—Ç–∞, –≥–ª–µ–¥–∞–π –∑–∞:
```javascript
[Registry Check] Starting check for: {full_name: "...", email: "..."}
[Registry Check] Success: {status: "ok", match_count: X, ...}
```

### –ê–∫–æ –∏–º–∞—à –≥—Ä–µ—à–∫–∏:
1. **"Unregistered API key"** ‚Üí –ó–Ω–∞—á–∏ –ù–ï —Å–∏ –∫–æ–ø–∏—Ä–∞–ª –Ω–æ–≤–∏—Ç–µ —Ñ–∞–π–ª–æ–≤–µ –ø—Ä–∞–≤–∏–ª–Ω–æ
2. **"Registry check failed"** ‚Üí –í–∏–∂ Supabase Function Logs –∑–∞ –¥–µ—Ç–∞–π–ª–∏
3. **–ù—è–º–∞ –∑–∞–ø–∏—Å–∏ –≤ —Ç–∞–±–ª–∏—Ü–∏—Ç–µ** ‚Üí –í–∏–∂ Supabase Function Logs, –≤–µ—Ä–æ—è—Ç–Ω–æ –∏–º–∞ DB permission –ø—Ä–æ–±–ª–µ–º

---

## üìä –ü—ä–ª–µ–Ω Workflow (—Å–µ–≥–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ–Ω!)

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ FRONTEND (Hostinger)                                         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
            ‚îÇ
            ‚îÇ 1. User populates form in chat
            ‚îú‚îÄ‚îÄ> useChatLogic.js
            ‚îÇ    ‚îî‚îÄ> Insert to users_pending ‚úÖ
            ‚îÇ    ‚îî‚îÄ> Call checkRegistry() hook
            ‚îÇ        ‚îî‚îÄ> useRegistryCheck.js
            ‚îÇ            ‚îî‚îÄ> supabase.functions.invoke('registry_check')
            ‚îÇ
            ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ BACKEND (Supabase Edge Functions)                           ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
            ‚îÇ
            ‚îú‚îÄ‚îÄ> registry_check (ONE FUNCTION DOES EVERYTHING!)
            ‚îÇ    ‚îÇ
            ‚îÇ    ‚îú‚îÄ> 1. Search CompanyBook API (via companybook_proxy)
            ‚îÇ    ‚îú‚îÄ> 2. Extract companies with 100% ownership
            ‚îÇ    ‚îú‚îÄ> 3. Enrich company data
            ‚îÇ    ‚îú‚îÄ> 4. INSERT into user_registry_checks ‚úÖ
            ‚îÇ    ‚îú‚îÄ> 5. UPDATE users_pending.status ‚úÖ
            ‚îÇ    ‚îú‚îÄ> 6. CALL users_pending_worker ‚úÖ
            ‚îÇ    ‚îÇ    ‚îî‚îÄ> Upsert verified_owners ‚úÖ
            ‚îÇ    ‚îÇ    ‚îî‚îÄ> Allocate phone & email alias ‚úÖ
            ‚îÇ    ‚îî‚îÄ> 7. SEND email notification ‚úÖ
            ‚îÇ
            ‚ñº
     ‚úÖ DONE! User is fully processed!
```

---

## üéâ –†–µ–∑—É–ª—Ç–∞—Ç

–°–ª–µ–¥ –∫–æ–ø–∏—Ä–∞–Ω–µ –Ω–∞ —Ñ–∞–π–ª–æ–≤–µ—Ç–µ –∏ —Ç–µ—Å—Ç–≤–∞–Ω–µ:
- ‚úÖ –ü–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–∏—Ç–µ –º–æ–≥–∞—Ç –¥–∞ —Å–µ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–∞—Ç –ø—Ä–µ–∑ —á–∞—Ç–∞ –ë–ï–ó –≥—Ä–µ—à–∫–∏
- ‚úÖ –î–∞–Ω–Ω–∏—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø—Ä–µ–º–∏–Ω–∞–≤–∞—Ç –ø—Ä–µ–∑ —Ü–µ–ª–∏—è workflow
- ‚úÖ –ó–∞–ø–∏—Å–≤–∞—Ç —Å–µ –≤ `user_registry_checks`
- ‚úÖ –ó–∞–ø–∏—Å–≤–∞—Ç —Å–µ –≤ `verified_owners` (–∞–∫–æ –∏–º–∞ —Ñ–∏—Ä–º–∏)
- ‚úÖ –ü–æ–ª—É—á–∞–≤–∞—Ç email —Å —Ä–µ–∑—É–ª—Ç–∞—Ç–∏—Ç–µ
- ‚úÖ Frontend –∫–æ–¥—ä—Ç –µ —á–∏—Å—Ç –∏ –ø—Ä–æ—Å—Ç

---

## üìû –ü–æ–¥–¥—Ä—ä–∂–∫–∞

–ê–∫–æ –∏–º–∞—à –≤—ä–ø—Ä–æ—Å–∏ –∏–ª–∏ –ø—Ä–æ–±–ª–µ–º–∏:
1. –ü—Ä–æ–≤–µ—Ä–∏ Supabase Function Logs
2. –ü—Ä–æ–≤–µ—Ä–∏ Browser Console (F12)
3. –ü—Ä–æ–≤–µ—Ä–∏ –¥–∞–ª–∏ —Ñ–∞–π–ª–æ–≤–µ—Ç–µ —Å–∞ –∫–æ–ø–∏—Ä–∞–Ω–∏ –ø—Ä–∞–≤–∏–ª–Ω–æ
4. –ü—Ä–æ–≤–µ—Ä–∏ –¥–∞–ª–∏ build –ø—Ä–æ—Ü–µ—Å—ä—Ç –µ –∑–∞–≤—ä—Ä—à–µ–Ω —É—Å–ø–µ—à–Ω–æ

---

**–°—ä–∑–¥–∞–¥–µ–Ω–æ:** 06.12.2025
**–í–µ—Ä—Å–∏—è:** 1.0
**Status:** ‚úÖ Ready for Production
