# ðŸŒ Telegram Browser Automation System
**Ð”Ð°Ñ‚Ð°:** 3 Ð”ÐµÐºÐµÐ¼Ð²Ñ€Ð¸ 2025  
**ÐœÐµÑ‚Ð¾Ð´:** Browserbase MCP + Browser-Use/Stagehand  
**Ð¡Ñ‚Ð°Ñ‚ÑƒÑ:** Design & Implementation

---

## ðŸŽ¯ Ð¦ÐµÐ»

ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ð·Ð°Ñ†Ð¸Ñ Ð½Ð° Telegram Web Ð¿Ñ€Ð¾Ñ„Ð¸Ð»Ð¸ Ð·Ð°:
- âœ… Scrapta Ð½Ð° Ð¿Ð¾Ñ‚Ñ€ÐµÐ±Ð¸Ñ‚ÐµÐ»Ð¸
- âœ… ÐžÑ‚Ð³Ð¾Ð²Ð¾Ñ€Ð¸ Ð½Ð° Ñ‡Ð°Ñ‚Ð¾Ð²Ðµ
- âœ… Ð˜Ð·Ð¿Ñ€Ð°Ñ‰Ð°Ð½Ðµ Ð½Ð° ÑÐ½Ð¸Ð¼ÐºÐ¸
- âœ… ÐŸÑƒÑÐºÐ°Ð½Ðµ Ð½Ð° Ñ€ÐµÐºÐ»Ð°Ð¼Ð¸ Ð² Ð³Ñ€ÑƒÐ¿Ð¸
- âœ… Ð£Ð¼Ð½Ð¾ Ð»Ð°Ð¹ÐºÐ²Ð°Ð½Ðµ Ð½Ð° ÑÑŠÐ¾Ð±Ñ‰ÐµÐ½Ð¸Ñ

---

## ðŸ—ï¸ ÐÑ€Ñ…Ð¸Ñ‚ÐµÐºÑ‚ÑƒÑ€Ð°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Browserbase MCP Session                  â”‚
â”‚                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚      Telegram Web (web.telegram.org)     â”‚   â”‚
â”‚  â”‚                                          â”‚   â”‚
â”‚  â”‚  Profile: Kristina / New Profile        â”‚   â”‚
â”‚  â”‚  Stealth Mode: ON                        â”‚   â”‚
â”‚  â”‚  Static Proxy: Configured                â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                  â”‚
â”‚  Extensions:                                     â”‚
â”‚  â€¢ Profile Manager                               â”‚
â”‚  â€¢ Stealth Mode                                  â”‚
â”‚  â€¢ Anti-Detection                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Automation Actions                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  1. Login & Session Management                  â”‚
â”‚  2. User Scraping                                â”‚
â”‚  3. Chat Responses                               â”‚
â”‚  4. Image Sending                                â”‚
â”‚  5. Group Posting                                â”‚
â”‚  6. Smart Liking (5-10 msg, no bots/admins)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Supabase Database                        â”‚
â”‚  â€¢ telegram_profiles                             â”‚
â”‚  â€¢ telegram_actions                              â”‚
â”‚  â€¢ telegram_liked_messages                       â”‚
â”‚  â€¢ telegram_scraped_users                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ðŸ“‹ Ð”ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ Ð¸ Ð›Ð¾Ð³Ð¸ÐºÐ°

### 1. Ð’Ð»Ð¸Ð·Ð°Ð½Ðµ Ð² ÐŸÑ€Ð¾Ñ„Ð¸Ð»
```javascript
// Login to Telegram Web with profile
async function loginTelegram(profileName = 'Kristina') {
  // Start Browserbase session with stealth
  await sessionCreate();
  
  // Navigate to Telegram Web
  await navigate('https://web.telegram.org');
  
  // Load profile or create new
  const profile = await loadProfile(profileName);
  
  // Login if needed (QR code or phone)
  await handleLogin(profile);
  
  return session;
}
```

### 2. Scraping Ð½Ð° ÐŸÐ¾Ñ‚Ñ€ÐµÐ±Ð¸Ñ‚ÐµÐ»Ð¸
```javascript
// Scrape users from groups
async function scrapeUsers(groupName) {
  // Navigate to group
  await navigate(`https://web.telegram.org/#/im?p=g${groupName}`);
  
  // Extract user list
  const users = await extract({
    instruction: 'Extract all usernames from the member list'
  });
  
  // Save to database
  await saveScrapedUsers(users);
  
  return users;
}
```

### 3. ÐžÑ‚Ð³Ð¾Ð²Ð¾Ñ€Ð¸ Ð½Ð° Ð§Ð°Ñ‚Ð¾Ð²Ðµ
```javascript
// Reply to chat messages
async function replyToChats() {
  // Get unread chats
  const chats = await extract({
    instruction: 'Find all unread chat conversations'
  });
  
  for (const chat of chats) {
    // Read message
    await act({ action: `Click on chat ${chat.name}` });
    
    const message = await extract({
      instruction: 'Get the last message text'
    });
    
    // Generate response (AI or template)
    const response = generateResponse(message);
    
    // Type and send
    await act({ action: 'Type in message input', variables: { text: response } });
    await act({ action: 'Click send button' });
  }
}
```

### 4. Ð˜Ð·Ð¿Ñ€Ð°Ñ‰Ð°Ð½Ðµ Ð½Ð° Ð¡Ð½Ð¸Ð¼ÐºÐ¸
```javascript
// Send images to chats
async function sendImage(chatName, imagePath) {
  // Open chat
  await act({ action: `Click on chat ${chatName}` });
  
  // Click attach button
  await act({ action: 'Click attach file button' });
  
  // Upload image
  await act({ action: 'Upload image file', variables: { path: imagePath } });
  
  // Send
  await act({ action: 'Click send button' });
}
```

### 5. ÐŸÑƒÑÐºÐ°Ð½Ðµ Ð½Ð° Ð ÐµÐºÐ»Ð°Ð¼Ð° Ð² Ð“Ñ€ÑƒÐ¿Ð¸
```javascript
// Post ads in groups
async function postAdInGroups(groups, adText) {
  for (const group of groups) {
    // Navigate to group
    await act({ action: `Open group ${group.name}` });
    
    // Type ad
    await act({ action: 'Type in message box', variables: { text: adText } });
    
    // Send
    await act({ action: 'Click send' });
    
    console.log(`âœ… Posted ad in ${group.name}`);
    
    // Wait between posts (anti-spam)
    await sleep(randomBetween(60000, 120000)); // 1-2 min
  }
}
```

### 6. Ð£Ð¼Ð½Ð¾ Ð›Ð°Ð¹ÐºÐ²Ð°Ð½Ðµ (Smart Liking)
```javascript
// Smart liking with rules
async function smartLiking(groupName) {
  // Navigate to group
  await act({ action: `Open group ${groupName}` });
  
  // Get last 20 messages
  const messages = await extract({
    instruction: 'Extract last 20 messages with author, text, and timestamp'
  });
  
  // Filter messages
  const likeable = messages.filter(msg => {
    // Don't like bots
    if (msg.author.endsWith('bot')) return false;
    
    // Don't like admins
    if (msg.isAdmin) return false;
    
    // Check if we liked from this user recently (last 1-2 hours)
    if (wasLikedRecently(msg.author)) return false;
    
    return true;
  });
  
  // Like every 5-10 messages
  const toLike = [];
  let counter = 0;
  for (const msg of likeable) {
    counter++;
    if (counter >= randomBetween(5, 10)) {
      toLike.push(msg);
      counter = 0;
    }
  }
  
  // Perform likes
  for (const msg of toLike) {
    await act({ action: `React to message ${msg.id} with thumbs up` });
    await saveLikedMessage(msg);
    await sleep(randomBetween(2000, 5000)); // 2-5 sec between likes
  }
  
  console.log(`âœ… Liked ${toLike.length} messages in ${groupName}`);
}
```

---

## ðŸ—„ï¸ Database Schema

```sql
-- Telegram profiles table
CREATE TABLE IF NOT EXISTS telegram_profiles (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  profile_name TEXT UNIQUE NOT NULL,
  phone_number TEXT,
  username TEXT,
  session_data JSONB,
  last_used TIMESTAMPTZ,
  status TEXT DEFAULT 'active',
  created_at TIMESTAMPTZ DEFAULT NOW()
);

-- Telegram actions log
CREATE TABLE IF NOT EXISTS telegram_actions (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  profile_id UUID REFERENCES telegram_profiles(id),
  action_type TEXT NOT NULL, -- 'scrape', 'reply', 'post', 'like', 'send_image'
  target TEXT, -- group/chat name
  details JSONB,
  performed_at TIMESTAMPTZ DEFAULT NOW()
);

-- Liked messages tracking (avoid double-liking)
CREATE TABLE IF NOT EXISTS telegram_liked_messages (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  profile_id UUID REFERENCES telegram_profiles(id),
  group_name TEXT NOT NULL,
  message_id TEXT NOT NULL,
  author_username TEXT,
  liked_at TIMESTAMPTZ DEFAULT NOW(),
  UNIQUE(profile_id, message_id)
);

-- Scraped users
CREATE TABLE IF NOT EXISTS telegram_scraped_users (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  profile_id UUID REFERENCES telegram_profiles(id),
  username TEXT NOT NULL,
  full_name TEXT,
  group_source TEXT,
  scraped_at TIMESTAMPTZ DEFAULT NOW(),
  contacted BOOLEAN DEFAULT FALSE,
  UNIQUE(profile_id, username, group_source)
);

-- Create indexes
CREATE INDEX idx_liked_messages_profile ON telegram_liked_messages(profile_id, liked_at);
CREATE INDEX idx_scraped_users_profile ON telegram_scraped_users(profile_id, scraped_at);
CREATE INDEX idx_actions_profile ON telegram_actions(profile_id, performed_at);
```

---

## ðŸ”§ Implementation Files

### File Structure
```
browserbase-worker/src/
â”œâ”€â”€ telegramBrowserWorker.mjs        # Main worker
â”œâ”€â”€ telegramProfileManager.mjs       # Profile management
â”œâ”€â”€ telegramActions.mjs              # Action handlers
â”œâ”€â”€ telegramSmartLiking.mjs          # Smart liking logic
â””â”€â”€ telegramScrapers.mjs             # User scraping
```

### Configuration
```javascript
// telegram-config.mjs
export const TELEGRAM_CONFIG = {
  webUrl: 'https://web.telegram.org',
  
  profiles: {
    kristina: {
      phone: '+358XXXXXXXXX',
      username: '@kristina_helper',
    }
  },
  
  liking: {
    minInterval: 5,  // Min messages between likes
    maxInterval: 10, // Max messages between likes
    recentWindow: 7200000, // 2 hours in ms
    excludeBots: true,
    excludeAdmins: true,
  },
  
  posting: {
    minDelay: 60000,  // 1 min between posts
    maxDelay: 120000, // 2 min between posts
  },
  
  scraping: {
    maxUsers: 100,
    includeInactive: false,
  }
};
```

---

## ðŸš€ Usage Examples

### Example 1: Start Session and Login
```javascript
import { loginTelegram } from './telegramBrowserWorker.mjs';

// Login with Kristina profile
const session = await loginTelegram('Kristina');
console.log('âœ… Logged in as Kristina');
```

### Example 2: Scrape Users from Group
```javascript
import { scrapeUsersFromGroup } from './telegramScrapers.mjs';

const users = await scrapeUsersFromGroup('Crypto Bulgaria');
console.log(`âœ… Scraped ${users.length} users`);
```

### Example 3: Post Ad in Multiple Groups
```javascript
import { postAdInGroups } from './telegramActions.mjs';

const groups = ['Crypto Bulgaria', 'Bitcoin BG', 'Blockchain Sofia'];
const ad = `ðŸš€ WALLESTER ÐšÐ Ð˜ÐŸÐ¢ÐžÐšÐÐ Ð¢Ð˜!\n\nâœ… Ð‘ÑŠÑ€Ð·Ð¾ Ð¾Ð´Ð¾Ð±Ñ€ÐµÐ½Ð¸Ðµ\nðŸ’¬ Ð¡Ð²ÑŠÑ€Ð¶Ð¸ ÑÐµ: @wallester_helper_bot`;

await postAdInGroups(groups, ad);
```

### Example 4: Smart Liking in Group
```javascript
import { smartLikingInGroup } from './telegramSmartLiking.mjs';

// Like messages smartly (every 5-10 msgs, no bots/admins)
await smartLikingInGroup('Crypto Bulgaria');
```

### Example 5: Reply to Chats
```javascript
import { replyToUnreadChats } from './telegramActions.mjs';

await replyToUnreadChats({
  responseTemplate: 'Ð—Ð´Ñ€Ð°Ð²ÐµÐ¹Ñ‚Ðµ! Ð‘Ð»Ð°Ð³Ð¾Ð´Ð°Ñ€Ñ Ð·Ð° ÑÑŠÐ¾Ð±Ñ‰ÐµÐ½Ð¸ÐµÑ‚Ð¾. ÐšÐ°Ðº Ð¼Ð¾Ð³Ð° Ð´Ð° Ð¿Ð¾Ð¼Ð¾Ð³Ð½Ð°?'
});
```

---

## ðŸŽ® Test Script

```javascript
#!/usr/bin/env node
// test_telegram_automation.mjs

import { 
  'cqhs-X0mcp0browserbase_session_create' as sessionCreate,
  'cqhs-X0mcp0browserbase_stagehand_navigate' as navigate,
  'cqhs-X0mcp0browserbase_stagehand_act' as act,
  'cqhs-X0mcp0browserbase_stagehand_extract' as extract,
  'cqhs-X0mcp0browserbase_screenshot' as screenshot,
} from '../mcp-tools'; // You'll use MCP tools

async function testTelegramAutomation() {
  console.log('ðŸš€ Starting Telegram Browser Automation Test...\n');
  
  // Step 1: Create session
  console.log('1ï¸âƒ£ Creating Browserbase session...');
  const session = await sessionCreate();
  console.log('âœ… Session created\n');
  
  // Step 2: Navigate to Telegram Web
  console.log('2ï¸âƒ£ Navigating to Telegram Web...');
  await navigate('https://web.telegram.org');
  await sleep(5000);
  console.log('âœ… Loaded Telegram Web\n');
  
  // Step 3: Take screenshot
  console.log('3ï¸âƒ£ Taking screenshot...');
  await screenshot('telegram_web_loaded');
  console.log('âœ… Screenshot saved\n');
  
  // Step 4: Check if logged in
  console.log('4ï¸âƒ£ Checking login status...');
  const loginStatus = await extract({
    instruction: 'Check if user is logged in or needs to login'
  });
  console.log(`Status: ${JSON.stringify(loginStatus)}\n`);
  
  // Step 5: If not logged in, show QR or phone login
  if (loginStatus.needsLogin) {
    console.log('âš ï¸ Login required. Please scan QR or enter phone.\n');
    await screenshot('telegram_login_screen');
  } else {
    console.log('âœ… Already logged in!\n');
    
    // Step 6: Get chat list
    console.log('5ï¸âƒ£ Getting chat list...');
    const chats = await extract({
      instruction: 'Extract list of all chats with names'
    });
    console.log(`Found ${chats.length} chats:`, chats);
  }
  
  console.log('\nðŸŽ‰ Test completed!');
}

// Run test
testTelegramAutomation().catch(console.error);
```

---

## ðŸ”’ Security & Stealth

### Stealth Ð ÐµÐ¶Ð¸Ð¼
```javascript
// Use stealth settings
const stealthConfig = {
  userAgent: 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36',
  timezone: 'Europe/Sofia',
  locale: 'bg-BG',
  webrtc: 'disabled',
  canvas: 'noise',
  webgl: 'noise',
};
```

### Proxy Configuration
```javascript
// Use static proxy
const proxyConfig = {
  host: 'proxy.example.com',
  port: 8080,
  username: 'user',
  password: 'pass',
  country: 'BG',
};
```

### Anti-Detection
- Random delays between actions (2-5 sec)
- Human-like mouse movements
- Random typing speeds
- Realistic pauses
- Session persistence

---

## ðŸ“Š Monitoring

### Action Logging
```javascript
async function logAction(profileId, actionType, target, details) {
  await supabase.from('telegram_actions').insert({
    profile_id: profileId,
    action_type: actionType,
    target: target,
    details: details,
    performed_at: new Date().toISOString(),
  });
}
```

### Dashboard Queries
```sql
-- Actions today
SELECT action_type, COUNT(*) as count
FROM telegram_actions
WHERE performed_at >= CURRENT_DATE
GROUP BY action_type;

-- Users scraped this week
SELECT COUNT(*) 
FROM telegram_scraped_users
WHERE scraped_at >= CURRENT_DATE - INTERVAL '7 days';

-- Likes given per group
SELECT group_name, COUNT(*) as likes
FROM telegram_liked_messages
WHERE liked_at >= CURRENT_DATE
GROUP BY group_name;
```

---

## ðŸŽ¯ Next Steps

1. **Create Database Tables** (run SQL above)
2. **Implement Worker Files**
3. **Setup Stealth Profile**
4. **Test with Kristina Profile**
5. **Deploy & Monitor**

---

**Last Updated:** 3 Ð”ÐµÐºÐµÐ¼Ð²Ñ€Ð¸ 2025, 16:00 EET  
**Status:** âœ… Design complete, ready for implementation
